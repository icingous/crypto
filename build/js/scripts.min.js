function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,c,s=[],l=!0,i=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){i=!0,o=e}finally{try{if(!l&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(i)throw o}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var cryptoCurrs=["ETH","LTC","BTC"],currencies=["USD","EUR","GBP","UAH"],signs=["$","€","£","₴"],urlBase="https://apiv2.bitcoinaverage.com/indices/global/ticker/",currencyElems=[],currentCurrElem=document.querySelector(".js-curr-selected"),cards=Array.from(document.querySelectorAll(".currency")),lastResults=null,mockData={ask:418.79,bid:418.35,last:418.66,high:418.83,low:417.1,open:{day:"417.73",week:"408.74",month:"439.27"},averages:{daily:418.98,weekly:418.39,monthly:419.76},volume:56542.49,changes:{price:{weekly:9.92,monthly:-20.62,daily:.93},percent:{weekly:2.43,monthly:-4.69,daily:.22}},volume_percent:66.42,timestamp:1458754392,display_timestamp:"Wed, 23 Mar 2016 17:33:12 +0000"},initEventHandling=function(){var t,r,e=document.querySelector(".selector__current"),n=document.querySelector(".selector__options"),o=document.querySelectorAll(".js-curr-option"),e=(e&&n&&0<o.length&&(e.addEventListener("click",function(e){e.stopPropagation(),n.classList.toggle("hidden")}),r=function(e){e.stopPropagation(),e.target.classList.remove("selector__current--highlighted")},currentCurrElem.addEventListener("mouseenter",t=function(e){e.stopPropagation(),e.target.classList.add("selector__current--highlighted")}),currentCurrElem.addEventListener("mouseleave",r),Array.from(o).forEach(function(e){e.addEventListener("mouseenter",t),e.addEventListener("mouseleave",r)})),document.addEventListener("click",function(){n.classList.contains("hidden")||n.classList.add("hidden")}),document.addEventListener("keydown",function(e){"Esc"!==e.key&&"Escape"!==e.key||n.classList.contains("hidden")||n.classList.add("hidden")}),document.querySelectorAll(".js-switch-container"));Array.from(e).forEach(function(a){a.addEventListener("click",function(e){if(e.target.classList.contains("js-switch-slider")||e.target.classList.contains("js-switch-thumb")){var t=a.querySelector(".js-switch");if(t&&(t.checked=!t.checked,lastResults)){var r=null;if(e.target.closest)r=e.target.closest(".js-currency");else for(var n=e.target.parentElement;n.classList.contains("js-currency")?r=n:n=n.parentElement,null===r;);var e=r.getAttribute("data-currency"),o=currentCurrElem.textContent,o=signs[currencies.indexOf(o)];setChanges(r,t.checked,lastResults[e].changes,o)}}})})},getRates=function(e){var r=[];return cryptoCurrs.forEach(function(e){var t=Promise.resolve(mockData);r.push(t)}),Promise.all(r)},changeSelectedCurrency=function(e,t){var r=currencyElems.filter(function(e){return e.classList.contains("hidden")})[0];currentCurrElem.textContent=t,e.classList.add("hidden"),r.classList.remove("hidden"),updateUI(t)};function updateUI(t){getRates(t).then(function(e){return e.reduce(function(e,t,r){return e[cryptoCurrs[r]]=t,e},{})}).then(function(e){return updateRates(t,e)}).catch(function(e){return console.log(e.message)})}function setChangeColor(e,t){t<0?(e.classList.remove("currency__change-value--ok"),e.classList.add("currency__change-value--danger")):(e.classList.remove("currency__change-value--danger"),e.classList.add("currency__change-value--ok"))}function setChanges(e,t,r,n){var o;console.log({changes:r}),t?(t=r.percent,o=e.querySelector(".js-hour-change"),isNaN(t.hourly)?o.textContent="":(o.textContent=formatNumber((t.hourly<0?"":"+")+t.hourly.toFixed(2))+"%",setChangeColor(o,t.hourly)),o=e.querySelector(".js-day-change"),isNaN(t.daily)?o.textContent="":(o.textContent=formatNumber((t.daily<0?"":"+")+t.daily.toFixed(2))+"%",setChangeColor(o,t.daily)),o=e.querySelector(".js-week-change"),isNaN(t.weekly)?o.textContent="":(o.textContent=formatNumber((t.weekly<0?"":"+")+t.weekly.toFixed(2))+"%",setChangeColor(o,t.weekly)),o=e.querySelector(".js-month-change"),isNaN(t.monthly)?o.textContent="":(o.textContent=formatNumber((t.monthly<0?"":"+")+t.monthly.toFixed(2))+"%",setChangeColor(o,t.monthly))):(o=r.price,t=e.querySelector(".js-hour-change"),isNaN(o.hourly)?t.textContent="":(t.textContent=formatNumber((o.hourly<0?"":"+")+(o.hourly||0).toFixed(2))+n,setChangeColor(t,o.hourly)),r=e.querySelector(".js-day-change"),isNaN(o.daily)?r.textContent="":(r.textContent=formatNumber((o.daily<0?"":"+")+o.daily.toFixed(2))+n,setChangeColor(r,o.daily)),t=e.querySelector(".js-week-change"),isNaN(o.weekly)?t.textContent="":(t.textContent=formatNumber((o.weekly<0?"":"+")+o.weekly.toFixed(2))+n,setChangeColor(t,o.weekly)),r=e.querySelector(".js-month-change"),isNaN(o.monthly)?r.textContent="":(r.textContent=formatNumber((o.monthly<0?"":"+")+o.monthly.toFixed(2))+n,setChangeColor(r,o.monthly)))}function updateRates(c,e){console.log({results:e}),lastResults=e,Object.entries(e).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1],r=cards.filter(function(e){return e.getAttribute("data-currency")===t})[0],n=r.querySelector(".js-price"),o=signs[currencies.indexOf(c)],a=r.querySelector(".js-switch").checked;n.textContent=o+formatNumber(e.last.toFixed(2),!1),setChanges(r,a,e.changes,o)})}var initUI=function(){var e=currencies[0],n=document.querySelector(".js-currency-list");currentCurrElem.textContent=e,Array.from(currencies).forEach(function(t,e){var r=document.createElement("li");r.className="selector__currency-item js-curr-option"+(0===e?" hidden":""),r.textContent=t,r.addEventListener("click",function(e){changeSelectedCurrency(r,t)}),n.appendChild(r),currencyElems.push(r)}),updateUI(e)};function formatNumber(e){for(var t,r="",e=((!(1<arguments.length&&void 0!==arguments[1])||arguments[1])&&(r=e[0],e=e.slice(1)),e.split(".")),n=[],o=Array.from(e[0]);t=0<(t=o.length%3)?o.splice(0,t):o.splice(0,Math.min(3,o.length)),n.push(t.join("")),0<o.length;);return r+(1<e.length?n.join(" ")+"."+e[1]:n.join(" "))}document.addEventListener("DOMContentLoaded",function(){initUI(),initEventHandling()});